apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Namespace para ambiente DEV no EKS (gerenciado pelo Terraform)
namespace: oficina-mecanica-dev

resources:
  # Base resources
  - ../../base

  # Dev-specific resources
  - namespace.yaml
  - secrets.yaml
  - ingress.yaml

# Patches espec√≠ficos para DEV
patches:
  # Garantir que imagens sempre sejam puxadas (evita cache em dev)
  - target:
      kind: Deployment
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/imagePullPolicy
        value: Always

# Labels comuns para ambiente DEV
commonLabels:
  environment: dev
  managed-by: terraform
  deployed-via: kustomize

# Annotations comuns
commonAnnotations:
  deployment-method: terraform-eks
  cluster: eks-fiap-oficina-mecanica
